---
output: github_document
---

[![Travis-CI Build Status](https://travis-ci.org/cboettig/rdflib.svg?branch=master)](https://travis-ci.org/cboettig/rdflib) 
[![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/cboettig/rdflib?branch=master&svg=true)](https://ci.appveyor.com/project/cboettig/rdflib)
[![Coverage Status](https://img.shields.io/codecov/c/github/cboettig/rdflib/master.svg)](https://codecov.io/github/cboettig/rdflib?branch=master)
[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/rdflib)](https://cran.r-project.org/package=rdflib)

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# rdflib

A friendly and consise user interface for performing common
tasks on rdf data, such as parsing and converting between
formats including rdfxml, turtle, nquads, ntriples,
and trig, creating rdf graphs, and performing SPARQL
queries. This package wraps the redland R package which
provides direct bindings to the redland C library. This
interface takes inspiration from the Python rdflib library.

## Installation

You can install rdflib from github with:

```{r gh-installation, eval = FALSE}
# install.packages("devtools")
devtools::install_github("cboettig/rdflib")
```


## Basic use

While not required, `rdflib` is designed to play nicely with `%>%` pipes, so we will load the `magrittr` package as well:

```{r, message=FALSE}
library(magrittr)
library(rdflib)
```

Parse a file and serialize into a different format:

```{r parse}
system.file("extdata", "dc.rdf", package="redland") %>%
  rdf_parse() %>%
  rdf_serialize("test.nquads", "nquads")
```


Perform SPARQL queries:

```{r sparql}
file <- system.file("extdata", "dc.rdf", package="redland")

sparql <-
 'PREFIX dc: <http://purl.org/dc/elements/1.1/>
  SELECT ?a ?c
  WHERE { ?a dc:creator ?c . }'

rdf <- rdf_parse(file)
rdf %>% query(sparql)

```

Initialize graph a new object or add triples statements to an existing graph:

```{r}
x <- rdf()
x <- rdf_add(x, 
    subject="http://www.dajobe.org/",
    predicate="http://purl.org/dc/elements/1.1/language",
    object="en")
x
```

Change the default display format (`nquads`) for graph objects:

```{r}
options(rdf_print_format = "jsonld")
x
```


## JSON-LD

We can also work with the JSON-LD format through additional functions provided in the 
R package, `jsonld`.  Note that at the time of writing, jsonld-rdf interface supports 
only the `nquads` serialization format.

```{r}
library(jsonld)

tmp <- tempfile()
rdf_serialize(x, tmp, "nquads")

str <- readLines(tmp) %>% jsonld_from_rdf() 
str
```

Likewise, we can convert JSON-LD data into an RDF model, on which we can then
perform SPARQL queries, add triples, or serialize into other formats. 

```{r}
tmp <- tempfile()
str %>% jsonld_to_rdf() %>% writeLines(tmp)
rdf <- rdf_parse(tmp, format = "nquads")
```


For more information on the JSON-LD RDF API, see <https://json-ld.org/spec/latest/json-ld-rdf/>.

```{r include=FALSE}
unlink("test.nquads")
```
